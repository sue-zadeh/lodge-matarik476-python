{% extends 'base.html' %}

{% block title %}Member Home{% endblock %}

{% block content %}
<div class="container mt-4">
<!--new file notification-->
  {% if new_files_count and new_files_count > 0 %}
  <div class="alert alert-info d-flex justify-content-between align-items-center">
    <div>
      <strong>You have {{ new_files_count }} new file{{ 's' if new_files_count > 1 else '' }}.</strong>
      <span class="ms-2">Latest: "{{ new_files[0].subject }}"</span>
    </div>
    <a href="{{ url_for('member_files') }}" class="btn btn-sm btn-outline-dark">
      <i class="fas fa-folder-open"></i> Open files
    </a>
  </div>
{% endif %}


  <!-- WELCOME + ANNOUNCEMENTS IN ONE ROW -->
  <div class="row mb-4 g-4">

    <!-- WELCOME CARD (LEFT) -->
    <div class="col-md-6">
      <div class="bg-dark bg-opacity-50 rounded-3 shadow-lg d-flex align-items-center p-4 hover-lift h-100" data-aos="fade-down-right" >
        <img
          src="{% if user.profile_image %}
                  {{ url_for('static', filename='uploads/' ~ user.profile_image) }}
               {% else %}
                  {{ url_for('static', filename='img/logo1.jpg') }}
               {% endif %}"
          alt="Member avatar"
          class="rounded-circle border border-warning me-3"
          style="width:72px;height:72px;object-fit:cover;"
        >
        <div>
          <p class="mb-1 small text-secondary">Welcome back,</p>
          <h6 class="mb-1 text-light">
            Welcome {{ user.first_name }} {{ user.last_name }}
          </h6>
          <span class="badge bg-warning text-dark">
            {{ user.role|capitalize }}Member 
          </span>
        </div>
      </div>
    </div>

    <!-- ANNOUNCEMENTS / NEXT EVENT (RIGHT) -->
    <div class="col-md-6">
      <div class="bg-dark bg-opacity-75 rounded-3 shadow-lg p-4 h-100 d-flex flex-column justify-content-between" data-aos="fade-down-left">
        <div>
          <h4 class="text-warning mb-2">
            <i class="fas fa-bullhorn me-2"></i> Lodge Announcements
          </h4>
          <p class="mb-2 text-light">
            Stay up to date with meeting nights, special events and important lodge news.
          </p>
        </div>

        {% if next_event %}
          <div class="mt-2">
            <p class="mb-1 text-light fw-semibold">
              {{ next_event.title }}
            </p>
            <p class="mb-1 text-light">
              {{ next_event.date_formatted }} &nbsp;
              <span class="text-warning">{{ next_event.time_formatted }}</span>
            </p>
            {% if next_event.description %}
              <p class="mb-0 text-secondary small">
                {{ next_event.description }}
              </p>
            {% endif %}
          </div>
        {% else %}
          <p class="mt-2 mb-0 text-secondary small">
            There are no upcoming events scheduled yet.
          </p>
        {% endif %}
      </div>
    </div>

  </div>

  <!-- HERO SECTION -->
  <section class="hero-section d-flex align-items-center text-center text-light shadow-lg rounded"
    style="background-image:
      linear-gradient(rgba(0,0,0,0.15), rgba(0,0,0,0.35)),
      url('{{ url_for('static', filename='img/members.png') }}');
      min-height: 420px;
      background-size: cover;
      background-position: center;" data-aos="fade-bottom">
  </section>

  <h1 class="fw-bold pt-2 text-light text-center" data-aos="fade-down-right">Welcome to Lodge Matariki 476</h1>
  <p class="fs-5 mt-3 text-center" data-aos="fade-down-left">
    Honouring tradition. Strengthening brotherhood. Building the future together.
  </p>

  <!-- QUICK LINKS -->
  <div class="row g-3 mt-1 justify-content-center">
    <div class="col-md-3" data-aos="fade-down-right">
      <a href="{{ url_for('profile') }}" class="text-decoration-none">
        <div class="card bg-dark text-light border-0 shadow-sm h-100 hover-lift">
          <div class="card-body text-center d-flex flex-column justify-content-between">
            <i class="fas fa-id-card fa-2x text-warning mb-3"></i>
            <h5 class="card-title">My Profile</h5>
            <p class="card-text small">
              View and update your personal details.
            </p>
          </div>
        </div>
      </a>
    </div>

    <div class="col-md-4 justify-content-center" data-aos="fade-down-right">
      <a href="#" class="text-decoration-none">
        <div class="card bg-dark text-light border-0 shadow-sm h-100 hover-lift">
          <div class="card-body text-center d-flex flex-column justify-content-between">
            <i class="fas fa-calendar fa-2x text-warning mb-3"></i>
            <h5 class="card-title">Calendar</h5>
            <p class="card-text small">
              Upcoming lodge meetings &amp; events (coming soon).
            </p>
          </div>
        </div>
      </a>
    </div>

    <!-- <div class="col-md-3">
      <a href="#" class="text-decoration-none">
        <div class="card bg-dark text-light border-0 shadow-sm h-100 hover-lift">
          <div class="card-body text-center d-flex flex-column justify-content-between">
            <i class="fas fa-bullhorn fa-2x text-warning mb-3"></i>
            <h5 class="card-title">Announcements</h5>
            <p class="card-text small">
              Latest lodge updates and notices (coming soon).
            </p>
          </div>
        </div>
      </a>
    </div> -->

    <div class="col-md-4" data-aos="fade-down-left" data-aos="fade-down-left">
      <a href="{{ url_for('member_files')}}" class="text-decoration-none">
        <div class="card bg-dark text-light border-0 shadow-sm h-100 hover-lift">
          <div class="card-body text-center d-flex flex-column justify-content-between">
            <i class="fas fa-folder-open fa-2x text-warning mb-3"></i>
            <h5 class="card-title">Files</h5>
            <p class="card-text small">
              Minutes, documents, and resources
            </p>
          </div>
        </div>
      </a>
    </div>
  </div>

  <!-- WHAT'S NEXT -message from Admin -->
<div class="p-4 bg-dark bg-opacity-50 rounded-3 shadow-sm mt-4" data-aos="fade-down-left">
  <h4 class="text-warning">
    <i class="fas fa-star"></i> Message from Admin
  </h4>

  {% if whats_next %}
    <p class="text-light mt-2 fs-4">
      {{ whats_next }}
    </p>
  {% else %}
<p class="card-text">
  {{ whats_next.note if whats_next else 'No message from admin yet.' }}
</p>
  {% endif %}
</div>

</div>
{% endblock %}
